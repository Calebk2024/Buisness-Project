<html>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <head>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <title>Expense Made Each Day</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
                background-color: white;
                text-align: center;
            }
            nav {
                background-color: black;
                overflow: hidden;
            }
        
            nav a {
                float: left;
                display: block;
                color: white;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
            }
        
            nav a:hover {
                background-color: #ddd;
                color:blue;
            }
        </style>
    </head>
    <body>
        <nav>
            <a href="index.html">Back to homepage</a>
            <a href="user.html">User Logging</a>
        </nav>
        <div id="plot"></div>
        <script>
            var myArray = JSON.parse(localStorage.getItem("myArray")) || [];
            function compare(a, b) {
                const A = new Date(a.transactionDate);
                const B = new Date(b.transactionDate);
                return A - B;
            }
            myArray.sort(compare);
            var dates = [];
            var values = [];
            var Maps = {};
            for (var i = 0; i < myArray.length; i++) {
                var d = myArray[i]["transactionDate"];
                var v = parseFloat(myArray[i]["amount"]);
                if (Maps.hasOwnProperty(d)) {
                    Maps[d] += v;
                } else {
                    Maps[d] = v;
                    dates.push(d); 
                }
            }
            for (var i = 0; i < dates.length; i++) {
                values.push(Maps[dates[i]]);
            }
            
            var dateObjects = dates.map(date => new Date(date+ "T00:00:00"));
            var trace = {
                x: dateObjects,
                y: values,
                type: 'scatter',
                mode: 'lines+markers'
            };
            var layout = {
                title: 'Expense Tracked Each Day',
                xaxis: {
                    title: 'Dates',
                    type: 'date',
                    //tickformat: '%Y-%m-%d',
                    tickformat:'%m-%d-%Y',
                    tickvals: dateObjects,
                    tickfont: {
                        color: 'black' 
                    }
                },
                yaxis: {
                    title: 'Expense Amount (US $)'
                }
            };
            Plotly.newPlot('plot', [trace], layout);
        </script>
    </body>
</html>
